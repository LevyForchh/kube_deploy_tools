# This is an example deploy.yaml, which tells kube_deploy_tools what
# deployment varieties exist for your project and any special parameters
# to inject into template rendering for each one.

version: 2

# Please only include the Kubernetes clusters your project will deploy to.
artifacts:
  - name: local-staging
    image_registry: local
    flags:
      target: local
      environment: staging
      cloud: local
  - name: colo-service-prod
    image_registry: aws
    flags:
      target: colo-service
      environment: prod
      cloud: colo
  - name: colo-service-staging
    image_registry: aws
    flags:
      target: colo-service
      environment: staging
      cloud: colo
  - name: dist-prod
    image_registry: gcp
    flags:
      target: dist
      environment: prod
      cloud: gcp
    include_dir:
      - nginx/

default_flags:
  pull_policy: IfNotPresent

image_registries:
  - name: aws
    driver: aws
    prefix: 1234.dkr.ecr.us-west-2.amazonaws.com
    config:
      region: us-west-2
  - name: gcp
    driver: gcp
    prefix: ***REMOVED***
  - name: local
    driver: noop
    prefix: local-registry

# The flavors section can be specified globally or at the cluster level. It's
# a freeform way to specify how you'd like to separate stages or kinds of
# deployments. For example: blue-green or canary-stable methodology.
flavors:
  default: {}
  # As an example, these flavors will define canary and stable tracks for every
  # cluster type, making config['release_track'] set in each flavor context for
  # use in template rendering.
  #
  # canary:
  #   release_track: canary
  # stable:
  #   release_track: stable

# Exclude the hooks section if you're not using a custom hook in your project.
# The default will always be used.
hooks:
  - default
  - scripts/render_deploys_hook
